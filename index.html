<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Plataforma Experimental</title>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow-x: hidden;
    transition: background 1.5s ease;
    background: black;
}

.container {
    text-align: center;
    width: 90%;
    max-width: 600px;
    padding: 20px;
}

input {
    padding: 12px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    text-align: center;
    color: #333;
    width: 80%;
}

button {
    margin-top: 15px;
    padding: 12px 25px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #00c6ff;
    color: black;
    font-weight: bold;
    transition: transform 0.2s;
}

button:hover {
    transform: scale(1.05);
}

.progress-bar {
    width: 300px;
    height: 10px;
    background: #333;
    margin: 20px auto;
    border-radius: 10px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    width: 0%;
    background: #00ffcc;
    transition: width 0.3s;
}

.signal {
    font-size: 40px;
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0% { opacity: 0.3; }
    50% { opacity: 1; }
    100% { opacity: 0.3; }
}

.flash {
    animation: flashScreen 0.1s infinite;
}

@keyframes flashScreen {
    0% { background: black; }
    50% { background: #330000; }
    100% { background: black; }
}

.screenOff {
    background: black !important;
}

.bigMessage {
    font-size: 45px;
    font-weight: bold;
    color: #00ffcc;
    text-shadow: 0 0 15px #00ffcc;
    animation: fadeInZoom 2s ease forwards;
}

@keyframes fadeInZoom {
    0% { opacity: 0; transform: scale(0.7); }
    100% { opacity: 1; transform: scale(1); }
}

@keyframes aparecer {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.loveMessage {
    font-size: 35px;
    color: white;
    margin-bottom: 20px;
    text-shadow: 0 0 10px white;
}

.mensajeBonito {
    font-size: 22px;
    margin-top: 15px;
    opacity: 0;
    transition: opacity 1s ease;
}

.florPixel {
    font-size: 35px;
    margin-top: 15px;
    margin-bottom: 15px;
    letter-spacing: 10px;
}

/* Secci√≥n de comentarios mejorada */
.comentarios-section {
    margin-top: 25px;
    background: rgba(0, 0, 0, 0.4);
    padding: 20px;
    border-radius: 15px;
    border: 1px solid #00ffcc;
    box-shadow: 0 0 15px rgba(0, 255, 204, 0.2);
}

textarea {
    width: 90%;
    height: 80px;
    border-radius: 8px;
    padding: 10px;
    margin-top: 10px;
    border: 1px solid #ccc;
    font-family: inherit;
    font-size: 15px;
    resize: none;
}
</style>
</head>

<body>
<div class="container" id="contenido"></div>

<script>
const URL_GOOGLE_SCRIPT = "https://script.google.com/macros/s/AKfycbw821J3AeHNvY7VY2SGKQ4Zy573SJMMDcTBhfXaJEjFQUPapBzEq4j7U0pD3QSTY9OjUw/exec";

const params = new URLSearchParams(window.location.search);
const modo = params.get("modo");

const temasNormales = [
    {titulo:"üèç Simulaci√≥n de Telemetr√≠a Racing",descripcion:"Sistema piloto de pruebas din√°micas urbanas."},
    {titulo:"‚öΩ Plataforma de An√°lisis Deportivo",descripcion:"Evaluaci√≥n estad√≠stica avanzada de rendimiento competitivo."},
    {titulo:"üîß Diagn√≥stico Inteligente de Talleres",descripcion:"Proyecto para evaluaci√≥n digital de servicios t√©cnicos."}
];

const temaEspecial = {
    titulo:"üåç Proyecto de Observaci√≥n Ambiental",
    descripcion:"Plataforma experimental enfocada en monitoreo natural."
};

let temaSeleccionado;

if(modo==="especial1"){
    temaSeleccionado = temaEspecial;
    document.body.style.background="linear-gradient(to right,#134e5e,#71b280)";
}else{
    temaSeleccionado = temasNormales[Math.floor(Math.random()*temasNormales.length)];
    document.body.style.background="linear-gradient(to right,#0f2027,#203a43,#2c5364)";
}

document.getElementById("pantalla").innerHTML=`
    <h2>Plataforma en fase experimental</h2>
    <p>Este sistema se encuentra en desarrollo y puede presentar comportamientos inesperados.</p>
    <p style="opacity:0.6;font-size:14px;">Versi√≥n Beta - Acceso limitado</p>
    <br>
    <button onclick="mostrarFormulario()">Entrar al sistema</button>
`;

function mostrarFormulario(){
    document.getElementById("pantalla").innerHTML=`
    <h1>${temaSeleccionado.titulo}</h1>
    <p>${temaSeleccionado.descripcion}</p>
    <br>
    <h3>Reg√≠strate para continuar</h3>
    <input type="text" id="nombreInput" placeholder="Ej: Yeisson Orellana">
    <br>
    <button onclick="guardarNombre()">Registrar acceso</button>
    `;
}

function capitalizarNombre(n){
    return n.trim().toLowerCase().split(/\s+/).map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ");
}

async function registrarEnExcel(nombre, tipo, mensaje = "") {
    try {
        fetch(URL_GOOGLE_SCRIPT, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ nombre: nombre, tipo: tipo, mensaje: mensaje })
        });
    } catch (e) { console.error("Error"); }
}

async function guardarNombre(){
    let nombre=document.getElementById("nombreInput").value.trim();
    if(nombre==="") return alert("Ingresa tu nombre");
    nombre = capitalizarNombre(nombre);
    registrarEnExcel(nombre, "ACCESO", "Entr√≥ a la plataforma");
    iniciarSecuencia(nombre);
}

async function iniciarSecuencia(nombreUsuario){
    const contenido=document.getElementById("pantalla");
    contenido.innerHTML=`<div>Cargando usuario...</div><div class="signal">üì°</div>`;
    await pausa(2000);
    contenido.innerHTML=`<div class="progress-bar"><div class="progress-fill" id="barra"></div></div>`;
    await animarBarra();
    
    document.body.classList.add("flash");
    await pausa(1000);
    document.body.classList.remove("flash");
    document.body.style.background="black";

    contenido.innerHTML=`<div class="bigMessage">"Respira... todo est√° bajo control."</div>`;
    await pausa(3000);

    let nB = nombreUsuario.toLowerCase();
    let esVIP = (modo === "especial1") && (nB.includes("maria") || nB.includes("fer") || nB.includes("kim") || nB.includes("pamela") || nB.includes("silvia") || nB.includes("tatiana"));

    mostrarRutaCompartida(nombreUsuario, esVIP);
}

function animarBarra(){
    return new Promise(resolve=>{
        let a=0; const b=document.getElementById("barra");
        const i=setInterval(()=>{
            a+=5; b.style.width=a+"%";
            if(a>=100){ clearInterval(i); resolve(); }
        },100);
    });
}

function pausa(ms){ return new Promise(res=>setTimeout(res,ms)); }

async function mostrarRutaCompartida(nombreUsuario, esVIP) {
    const contenedor = document.getElementById("pantalla");
    document.body.style.background = "linear-gradient(to right, #6a11cb, #2575fc)";
    
    const mensajesLargos = [
        "A veces la vida nos pone pruebas para recordarnos de qu√© estamos hechos. Tienes una fuerza interior incre√≠ble.",
        "Tu historia est√° llena de cap√≠tulos hermosos que a√∫n no se han escrito. Mant√©n la esperanza alta.",
        "Eres una persona maravillosa, capaz de lograr todo lo que te propongas. No dejes de brillar."
    ];

    for(let m of mensajesLargos) {
        contenedor.innerHTML = `<div style="animation: aparecer 1s forwards;"><div class="florPixel">‚ú® üå∏ ‚ú®</div><p style="font-size:20px; line-height:1.6;">${m}</p></div>`;
        await pausa(4000);
    }

    if (esVIP) {
        contenedor.innerHTML = `
            <div style="animation: aparecer 1s forwards;">
                <h1 style="color:#ffcc00;">üéÅ Tienes un regalo especial</h1>
                <button onclick="window.location.href='especial.html?nombre=' + encodeURIComponent('${nombreUsuario}')">ABRIR SORPRESA</button>
            </div>`;
    } else {
        contenedor.innerHTML = `
            <div style="animation: aparecer 1s forwards;">
                <div style="font-size: 50px;">üòä</div>
                <h2>¬°Espero haberte sacado una sonrisa!</h2>
                
                <div id="zonaComentario" class="comentarios-section">
                    <p style="margin:0;">¬øQu√© te pareci√≥ este peque√±o detalle?</p>
                    <textarea id="comentarioTexto" placeholder="Escribe un mensaje aqu√≠..."></textarea>
                    <br>
                    <button id="btnEnv" onclick="enviarFinal('${nombreUsuario}')">Enviar Mensaje</button>
                </div>
                
                <p style="margin-top:20px; font-size:12px; opacity:0.7;">Creado por Yeisson Moises Orellana Grande</p>
            </div>`;
    }
}

async function enviarFinal(nom) {
    const txt = document.getElementById("comentarioTexto").value;
    if(txt.trim()==="") return alert("Escribe algo primero üòä");
    document.getElementById("btnEnv").innerText = "Enviando...";
    await registrarEnExcel(nom, "COMENTARIO", txt);
    document.getElementById("zonaComentario").innerHTML = "<p style='color:#00ffcc; font-weight:bold;'>¬°Mensaje enviado con √©xito! Gracias por participar. üòä</p>";
}
</script>
</body>
</html>

